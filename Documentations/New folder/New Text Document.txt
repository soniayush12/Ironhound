from pytube import YouTube
from pytube.contrib.playlist import Playlist
import os

def download_video(video_url, output_folder):
    try:
        yt = YouTube(video_url)
        print(f"Downloading: {yt.title}")
        video = yt.streams.filter(file_extension="mp4").get_highest_resolution()
        if video:
            video.download(output_path=output_folder)
            print(f"Downloaded: {yt.title}")
        else:
            print(f"No suitable MP4 stream found for: {yt.title}")
    except Exception as e:
        print(f"Error downloading {video_url}: {e}")

def download_playlist(playlist_url):
    try:
        playlist = Playlist(playlist_url)
        print(f"Playlist Title: {playlist.title}")
        print(f"Number of videos: {len(playlist.video_urls)}")

        # Use playlist title as output folder name
        output_folder = playlist.title

        # Create output folder if it doesn't exist
        if not os.path.exists(output_folder):
            os.makedirs(output_folder)

        for video_url in playlist.video_urls:
            download_video(video_url, output_folder)

        print("All videos downloaded successfully.")
    except Exception as e:
        print(f"Error with playlist: {e}")

if __name__ == "__main__":
    playlist_link = input("Enter the YouTube playlist link: ")
    download_playlist(playlist_link)
